var D=Object.defineProperty;var I=(c,e,t)=>e in c?D(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var g=(c,e,t)=>I(c,typeof e!="symbol"?e+"":e,t);import{p as h,T as d,q as R,r as m,t as q,v as f,w as p,j as y,k as v,m as E,n as S,x as N}from"./vendor-firebase-BgMWbdUj.js";import{g as a,h as n}from"./index-Dh6OigyZ.js";class x{constructor(e){g(this,"collectionName");this.collectionName=e}async add(e,t=!0){if(!e)throw new Error(`Invalid data for ${this.collectionName}`);const o=a(),r=h(n,"users",o,this.collectionName),i=t?{date:d.now(),createdAt:d.now(),updatedAt:d.now()}:{};return(await R(r,{...e,...i})).id}async getAll(e){const t=a();if(!t)throw new Error("User not authenticated");const o=h(n,"users",t,this.collectionName),r=e?m(o,f("date","desc"),q(e)):m(o,f("date","desc"));return(await p(r)).docs.map(s=>({id:s.id,...s.data()}))}async getById(e){if(!e)throw new Error(`Invalid ID for fetching ${this.collectionName}`);try{const t=a();if(!t)throw new Error("User not authenticated");const o=y(n,"users",t,this.collectionName,e),r=await v(o);return r.exists()?{id:r.id,...r.data()}:null}catch(t){return console.error(`Error fetching ${this.collectionName} document ${e}:`,t),null}}async update(e,t){if(!e||!t)throw new Error(`Invalid parameters for update ${this.collectionName}`);const o=a(),r=y(n,"users",o,this.collectionName,e);return await E(r,{...t,updatedAt:d.now()}),!0}async delete(e){if(!e)throw new Error(`Invalid ID for delete ${this.collectionName}`);const t=a(),o=y(n,"users",t,this.collectionName,e);return await S(o),!0}async getByDateRange(e,t,o="date"){if(!e||!t)throw new Error(`Invalid date parameters for ${this.collectionName} date range query`);const r=a(),i=h(n,"users",r,this.collectionName),s=m(i,N(o,">=",d.fromDate(e)),N(o,"<=",d.fromDate(t)),f(o,"desc"));return(await p(s)).docs.map(l=>({id:l.id,...l.data()}))}async getByDate(e,t="date"){const o=new Date(e);o.setHours(0,0,0,0);const r=new Date(e);return r.setHours(23,59,59,999),this.getByDateRange(o,r,t)}async query(e=[],t="date",o="desc",r){const i=a(),s=h(n,"users",i,this.collectionName),w=[...e.map(u=>N(u.field,u.operator,u.value)),f(t,o)];r&&w.push(q(r));const l=m(s,...w);return(await p(l)).docs.map(u=>({id:u.id,...u.data()}))}}export{x as F};
