import{c as ce,r as l,j as e,k as C,B as E,C as q,b as Q,d as le,I as de,S as ue,e as X,K as Z,M as G,N as J,O as ee,Q as se,V as xe,L as te,i as me,Y as re,Z as A,T,_ as he}from"./index-MKLLRtOd.js";import{a0 as Re,$ as Fe}from"./index-MKLLRtOd.js";import{T as ae,u as fe}from"./useDebounce-D3Pr2oQl.js";import{C as ne}from"./circle-plus-UnoKZIFD.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],oe=ce("info",pe),P=({initialValue:t,onSave:s,as:n="span",className:c,inputClassName:h,type:N="text",displayTextPlaceholder:j="Click to edit",inputProps:d})=>{const[u,w]=l.useState(!1),[g,p]=l.useState(t),v=l.useRef(null),S=n;l.useEffect(()=>{u||p(t)},[t,u]),l.useEffect(()=>{u&&v.current&&v.current.focus()},[u]);const I=()=>{w(!1),s(g.toString())},F=()=>{p(t),w(!1)},D=r=>{p(r.target.value)},m=r=>{r.key==="Enter"?(r.preventDefault(),I()):r.key==="Escape"&&F()},o=()=>{w(!0)},i=r=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),w(!0))};if(u)return e.jsx("input",{ref:v,type:N,value:g,onChange:D,onBlur:I,onKeyDown:m,spellCheck:"false",className:C(c,"bg-transparent border-input focus:border-primary outline-none","text-inherit font-inherit m-0","min-w-[50px]","underline underline-offset-2 decoration-dashed decoration-muted-foreground",N==="number"&&"appearance-none [-moz-appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-outer-spin-button]:m-0 [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-inner-spin-button]:m-0",h),...d});const x=String(g).trim()===""?j:g;return e.jsx(S,{onClick:o,onKeyDown:i,className:C("cursor-text hover:bg-muted/30 dark:hover:bg-muted/20 transition-colors underline underline-offset-2  decoration-muted-foreground",{"text-muted-foreground italic":String(g).trim()===""&&x===j},c),tabIndex:0,role:"button","aria-label":`Edit text. Current value: ${String(g).trim()===""?"empty, placeholder is "+j:g}`,children:x})},je=({searchResults:t,onViewExercise:s,onSelectExercise:n})=>e.jsx("div",{className:"space-y-2",children:t.map(c=>e.jsxs("div",{className:"flex justify-between items-center p-4 border rounded-md bg-card text-card-foreground",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:c.name}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{variant:"ghost",size:"icon",onClick:()=>s==null?void 0:s(c.exerciseId),children:e.jsx(oe,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(E,{variant:"ghost",size:"sm",onClick:()=>n(c.exerciseId),children:"Add"})]})]},c.exerciseId))}),ge=({searchTerm:t,searchResults:s,isSearching:n,error:c,onSearchChange:h,onSelectExercise:N,onViewExercise:j,className:d})=>e.jsxs(q,{className:C("h-full flex flex-col",d),children:[e.jsx(Q,{className:"py-3 px-3",children:e.jsx(le,{className:"text-base",children:"Exercise Library"})}),e.jsx("div",{className:"px-3 pb-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(de,{placeholder:"Search exercises...",value:t,onChange:h,className:"pr-8"}),e.jsx(ue,{className:"absolute right-2 top-2.5 h-4 w-4 text-muted-foreground"})]})}),e.jsx(X,{className:"flex-1 p-2 overflow-y-auto max-h-[calc(100vh-200px)]",children:n?e.jsx("div",{className:"flex items-center justify-center h-24",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Searching..."})}):c?e.jsx("div",{className:"flex items-center justify-center h-24",children:e.jsx("p",{className:"text-sm text-destructive",children:c})}):t.trim()!==""&&s.length===0?e.jsx("div",{className:"flex items-center justify-center h-24",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No exercises found"})}):t.trim()===""?e.jsx("div",{className:"flex items-center justify-center h-24",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter a keyword to search exercises"})}):e.jsx(je,{searchResults:s,onSelectExercise:N,onViewExercise:j})})]}),be=({title:t,isOpen:s,onClose:n,children:c})=>e.jsx(Z,{open:s,onOpenChange:n,children:e.jsxs(G,{children:[e.jsxs(J,{children:[e.jsxs(ee,{children:["Add Exercise to ",t]}),e.jsx(se,{children:"Search and select an exercise to add to your workout."})]}),e.jsx("div",{className:"mt-4 h-96",children:c})]})});function Ne({className:t,...s}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:C("w-full caption-bottom text-sm",t),...s})})}function ke({className:t,...s}){return e.jsx("thead",{"data-slot":"table-header",className:C("[&_tr]:border-b",t),...s})}function we({className:t,...s}){return e.jsx("tbody",{"data-slot":"table-body",className:C("[&_tr:last-child]:border-0",t),...s})}function B({className:t,...s}){return e.jsx("tr",{"data-slot":"table-row",className:C("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...s})}function L({className:t,...s}){return e.jsx("th",{"data-slot":"table-head",className:C("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}function M({className:t,...s}){return e.jsx("td",{"data-slot":"table-cell",className:C("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}const ye=({exercise:t,onAddSet:s,onDeleteSet:n,OnSaveReps:c,OnSaveWeight:h,className:N,id:j})=>{const{sets:d=0,weight:u=0,reps:w=0,exerciseId:g}=t;return e.jsx("div",{className:`rounded border p-4 bg-card text-card-foreground ${N??""}`,id:j,children:e.jsxs(Ne,{children:[e.jsx(ke,{children:e.jsxs(B,{children:[e.jsx(L,{className:"w-1/4",children:"Set"}),e.jsx(L,{className:"w-1/4",children:"Reps"}),e.jsx(L,{className:"w-1/4",children:"Weight"}),e.jsx(L,{className:"w-1/4 text-right"})]})}),e.jsxs(we,{children:[Array.from({length:d},(p,v)=>e.jsxs(B,{children:[e.jsx(M,{children:v+1}),e.jsx(M,{children:e.jsx(P,{className:"w-16",initialValue:w,onSave:S=>c&&c(S)})}),e.jsx(M,{children:e.jsx(P,{className:"w-16",initialValue:u,onSave:S=>h&&h(S)})}),e.jsx(M,{className:"text-right",children:d>1&&e.jsx(E,{variant:"ghost",size:"icon",onClick:n?()=>n(g):void 0,children:e.jsx(ae,{className:"h-4 w-4"})})})]},v)),e.jsx(B,{children:e.jsx(M,{colSpan:4,className:"text-center ",children:e.jsx(E,{variant:"ghost",size:"icon",onClick:s?()=>s(g):void 0,className:"w-full",children:e.jsx(ne,{className:"h-full w-3"})})})})]})]})})},ve=({exercise:t,isOpen:s,onClose:n})=>t?e.jsx(Z,{open:s,onOpenChange:n,children:e.jsxs(G,{className:"max-w-md",children:[e.jsxs(J,{children:[e.jsx(ee,{children:t.name}),e.jsxs(se,{children:[t.targetMuscles," - ",t.equipments]})]}),e.jsx("div",{className:"space-y-4 mt-4",children:t.instructions&&t.instructions.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Instructions:"}),t.instructions.map((c,h)=>e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:c},h))]})}),e.jsx(xe,{className:"flex justify-between",children:e.jsx(E,{onClick:n,size:"sm",children:"Close"})})]})}):null,Se=({children:t,plannedExercise:s,workout:n,isSearching:c,removeExerciseFromWorkout:h,handleViewExerciseDetails:N})=>e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx("div",{children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(E,{variant:"ghost",size:"icon",onClick:()=>N(s.exerciseId),"aria-label":`View details for ${s.name}`,children:c?e.jsx(te,{className:"h-4 w-4 animate-spin"}):e.jsx(oe,{className:"h-4 w-4"})}),e.jsx(E,{variant:"ghost",size:"icon",onClick:()=>h(n.id,s.exerciseId),"aria-label":`Remove ${s.name} from workout`,children:e.jsx(ae,{className:"h-4 w-4 text-red-400"})})]})})]}),t]},s.exerciseId),Ce=()=>{const[t,s]=l.useState(""),n=fe(t,500),[c,h]=l.useState(!1),[N,j]=l.useState([]),[d,u]=l.useState(null);l.useEffect(()=>{(async()=>{if(!n.trim()){j([]);return}h(!0),u(null);try{const p=await Y.searchExercises(n);p.success&&Array.isArray(p.data)?j(p.data):(u("Couldn't retrieve exercise data. Format error."),j([]))}catch(p){console.error("Error searching exercises:",p),u("Couldn't connect to exercise database."),j([])}finally{h(!1)}})()},[n]);const w=l.useCallback(async g=>{h(!0);try{const p=await Y.getExerciseById(g);return p.success?p.data:(u("Failed to fetch exercise details. Please try again."),null)}catch(p){return console.error("Error fetching exercise details:",p),u("Failed to fetch exercise details. Please try again."),null}finally{h(!1)}},[]);return{searchTerm:t,searchResults:N,isSearching:c,error:d,setSearchTerm:s,selectExercise:w}},H=(t,s)=>{const n=T.now();return{id:`temp-plan-${n.toMillis()}`,name:t,workouts:s,createdAt:n,updatedAt:n}},Ee=()=>{const{user:t}=me(),{state:s}=re(),n=s.userPreferences.workoutDaysPerWeek,[c,h]=l.useState(!0),[N,j]=l.useState(!1),[d,u]=l.useState(void 0);l.useEffect(()=>{if(h(!0),t){const m=Array.from({length:n},(o,i)=>({id:`workout-template-${Date.now()}-${i}`,name:`Workout ${i+1}`,exercises:[],completed:!1}));u(H("My Workout Plan",m))}else u(void 0);h(!1)},[t,n]);const w=l.useCallback((m,o)=>{u(i=>{if(!i)return i;const x=i.workouts.map(r=>{if(r.id!==m)return r;if(r.exercises.some(k=>k.exerciseId===o.exerciseId))return A.error("Exercise Already Exists",{description:`"${o.name}" is already in "${r.name}".`}),r;const b={...o,sets:1,reps:10,weight:0};return A("Exercise Added",{description:`"${o.name}" added to "${r.name}".`}),{...r,exercises:[...r.exercises,b]}});return{...i,workouts:x,updatedAt:T.now()}})},[]),g=l.useCallback((m,o)=>{u(i=>{if(!i)return i;let x,r;const b=i.workouts.map(k=>{if(k.id!==m)return k;const W=k.exercises.find($=>$.exerciseId===o);return W&&(x=W.name,r=k.name),{...k,exercises:k.exercises.filter($=>$.exerciseId!==o)}});return x&&r&&A("Exercise Removed",{description:`"${x}" removed from "${r}".`}),{...i,workouts:b,updatedAt:T.now()}})},[]),p=l.useCallback((m,o,i)=>{u(x=>{if(!x)return x;const r=x.workouts.map(b=>{if(b.id!==m)return b;const k=b.exercises.map(W=>{if(W.exerciseId!==o)return W;const $=b.exercises.find(z=>z.exerciseId===o),R={...W,...i};return i.sets!==void 0&&$&&A.info(`Sets for ${$.name} updated to ${i.sets} in ${b.name}`),R});return{...b,exercises:k}});return{...x,workouts:r,updatedAt:T.now()}})},[]),v=l.useCallback((m,o)=>{u(i=>{if(!i)return i;const x=i.workouts.map(r=>r.id===m?{...r,name:o}:r);return{...i,workouts:x,updatedAt:T.now()}})},[]),S=l.useCallback(m=>{u(o=>{const i=T.now();if(!o){const x=Array.from({length:n},(r,b)=>({id:`workout-template-${Date.now()}-${b}`,name:`Workout ${b+1}`,exercises:[]}));return H(m,x)}return{...o,name:m,updatedAt:i}})},[n]),I=l.useCallback(()=>{if(!t){A.error("User not authenticated. Cannot save workout plan.");return}if(!d){A.error("Workout plan is not initialized. Cannot save.");return}const m=d.name||"My Workout Plan",o=T.now(),i=d.id&&!d.id.startsWith("temp-plan-")?d.id:`${m.replace(/\s+/g,"-")}-${o.toMillis()}`,x={...d,id:i,name:m,updatedAt:o,createdAt:d.createdAt||o};return u(x),x},[t,d]),F=l.useMemo(()=>(d==null?void 0:d.workouts)||[],[d]),D=l.useCallback(async()=>{const m=I();if(!m)return!1;j(!0);try{return await he(m),!0}catch(o){return console.error("Error saving workout plan:",o),!1}finally{j(!1)}},[I]);return{isLoading:c,isSaving:N,plannedWorkouts:d,workouts:F,numberOfWorkoutsPerWeek:n,addExerciseToWorkout:w,removeExerciseFromWorkout:g,updateExerciseInWorkout:p,preparePlanForSave:I,setWorkoutName:v,setWorkoutTitle:S,saveWorkoutPlan:D}},Ae=()=>{var K;const{workouts:t,plannedWorkouts:s,isLoading:n,isSaving:c,addExerciseToWorkout:h,removeExerciseFromWorkout:N,updateExerciseInWorkout:j,setWorkoutTitle:d,setWorkoutName:u,saveWorkoutPlan:w}=Ee(),{state:g,setWorkoutDaysPerWeek:p}=re(),{searchTerm:v,searchResults:S,isSearching:I,error:F,setSearchTerm:D,selectExercise:m}=Ce(),[o,i]=l.useState(null),[x,r]=l.useState(null),b=a=>{i(a)},k=async a=>{const f=await m(a);f&&r(f)},W=a=>{o&&h(o,a),R()},$=a=>{if(o){const f=S.find(y=>y.exerciseId===a);f&&h(o,f)}R()},R=()=>{i(null),r(null),D("")},z=(a,f,y)=>{const _=f.sets||0,O=y?_+1:Math.max(0,_-1);j(a,f.exerciseId,{sets:O})},V=(a,f,y,_)=>{console.log("reps",y);const O=typeof y=="string"?parseInt(y,10):y;isNaN(O)||j(a,f.exerciseId,{[_]:O})},ie=async()=>{await w()?A.success("Workout plan saved successfully!"):A.error("Failed to save workout plan.")};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx(P,{as:"h1",className:"text-2xl font-bold",initialValue:(s==null?void 0:s.name)||"",onSave:a=>d(a)}),e.jsx("div",{className:"flex justify-end items-center space-x-4",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["You prefer to work out",e.jsx(P,{as:"span",className:"font-medium mx-1 fit-content w-8",initialValue:g.userPreferences.workoutDaysPerWeek.toString(),onSave:a=>p(parseInt(a)),type:"number"}),"times a week."]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map(a=>e.jsxs(q,{id:`workout-${a.id}`,children:[e.jsx(Q,{children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsx("div",{className:"flex flex-row justify-between items-center w-full",children:e.jsx(P,{className:"text-sm font-semibold",initialValue:a.name,onSave:f=>u(a.id,f)})})})}),e.jsxs(X,{children:[e.jsxs(E,{variant:"outline",className:"w-full mb-4",onClick:()=>b(a.id),children:[e.jsx(ne,{className:"mr-2 h-4 w-4"})," Add Exercise"]}),e.jsx("div",{className:"space-y-4",children:a.exercises.map(f=>e.jsx(Se,{plannedExercise:f,workout:a,removeExerciseFromWorkout:N,handleViewExerciseDetails:k,children:e.jsx(ye,{exercise:f,onAddSet:()=>z(a.id,f,!0),onDeleteSet:()=>z(a.id,f,!1),OnSaveReps:y=>V(a.id,f,y,"reps"),OnSaveWeight:y=>V(a.id,f,y,"weight")})},f.exerciseId))})]})]},a.id))}),e.jsx(ve,{exercise:x,isOpen:!!x,onClose:R}),e.jsx(be,{title:`Add Exercise to ${((K=t.find(a=>a.id===o))==null?void 0:K.name)||"Workout"}`,isOpen:!!o,onClose:R,onSelectExercise:W,onViewExercise:()=>console.log(""),children:e.jsx(ge,{searchTerm:v,searchResults:S,isSearching:I,error:F,onSearchChange:a=>D(a.target.value),onSelectExercise:$,onViewExercise:k})}),e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsxs(E,{variant:"default",onClick:ie,disabled:n||!s,children:[c&&e.jsx(te,{className:"animate-spin mr-2"}),"Save Workout Plan"]})})]})},U="https://exercisedb-api.vercel.app/api/v1",Y={getExerciseById:async t=>{try{const s=await fetch(`${U}/exercises/${t}`);if(!s.ok)throw new Error(`Exercise API error: ${s.status}`);return await s.json()}catch(s){throw console.error(`Error getting exercise data for ID ${t}:`,s),s}},searchExercises:async t=>{try{const s=await fetch(`${U}/exercises/autocomplete?search=${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Exercise API error: ${s.status}`);return await s.json()}catch(s){throw console.error("Error searching exercises:",s),s}}};export{ve as DetailsDialog,ye as ExerciseItem,ge as SearchPanel,be as SelectionDialog,Se as WorkoutColumn,Ae as WorkoutPlanner,he as addPlannedWorkout,Re as deletePlannedWorkout,Y as exerciseApi,Fe as getPlannedWorkouts,Ce as useExerciseData,Ee as useWorkoutPlanner};
//# sourceMappingURL=index-Bnw9aQsl.js.map
