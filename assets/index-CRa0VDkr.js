import{c as We,r as o,j as e,f as w,n as q,p as Re,q as Ae,w as De,s as te,x as Te,B as R,C as ne,a as oe,b as Pe,I as $e,d as ie,y as _e,z as Fe,A as ce,E as Oe,F as le,G as de,O as ue,L as me,e as ze,H as fe,J as T,T as $}from"./index-D4A55r9M.js";import{S as Be,X as Me,T as xe,u as Le}from"./useDebounce-DZCDvCmu.js";import{C as he,F as Ve}from"./firestore-DqkfDWpO.js";import{u as He,C as qe}from"./check-eVLZ_fta.js";/**
 * @license lucide-react v0.503.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],pe=We("info",Ke),O=({initialValue:t,onSave:s,as:r="span",className:a,inputClassName:n,type:i="text",displayTextPlaceholder:m="Click to edit",inputProps:d})=>{const[c,j]=o.useState(!1),[b,h]=o.useState(t),k=o.useRef(null),N=r;o.useEffect(()=>{c||h(t)},[t,c]),o.useEffect(()=>{c&&k.current&&k.current.focus()},[c]);const C=()=>{j(!1),s(b.toString())},E=()=>{h(t),j(!1)},I=f=>{h(f.target.value)},u=f=>{f.key==="Enter"?(f.preventDefault(),C()):f.key==="Escape"&&E()},l=()=>{j(!0)},x=f=>{(f.key==="Enter"||f.key===" ")&&(f.preventDefault(),j(!0))};if(c)return e.jsx("input",{ref:k,type:i,value:b,onChange:I,onBlur:C,onKeyDown:u,spellCheck:"false",className:w(a,"bg-transparent border-input focus:border-primary outline-none","text-inherit font-inherit m-0","min-w-[50px]","underline underline-offset-2 decoration-dashed decoration-muted-foreground",i==="number"&&"appearance-none [-moz-appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-outer-spin-button]:m-0 [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-inner-spin-button]:m-0",n),...d});const g=String(b).trim()===""?m:b;return e.jsx(N,{onClick:l,onKeyDown:x,className:w("cursor-text hover:bg-muted/30 dark:hover:bg-muted/20 transition-colors underline underline-offset-2  decoration-muted-foreground",{"text-muted-foreground italic":String(b).trim()===""&&g===m},a),tabIndex:0,role:"button","aria-label":`Edit text. Current value: ${String(b).trim()===""?"empty, placeholder is "+m:b}`,children:g})};function Ue(t){const s=Xe(t),r=o.forwardRef((a,n)=>{const{children:i,...m}=a,d=o.Children.toArray(i),c=d.find(Je);if(c){const j=c.props.children,b=d.map(h=>h===c?o.Children.count(j)>1?o.Children.only(null):o.isValidElement(j)?j.props.children:null:h);return e.jsx(s,{...m,ref:n,children:o.isValidElement(j)?o.cloneElement(j,void 0,b):null})}return e.jsx(s,{...m,ref:n,children:i})});return r.displayName=`${t}.Slot`,r}function Xe(t){const s=o.forwardRef((r,a)=>{const{children:n,...i}=r,m=o.isValidElement(n)?Ze(n):void 0,d=q(m,a);if(o.isValidElement(n)){const c=Ye(i,n.props);return n.type!==o.Fragment&&(c.ref=d),o.cloneElement(n,c)}return o.Children.count(n)>1?o.Children.only(null):null});return s.displayName=`${t}.SlotClone`,s}var Ge=Symbol("radix.slottable");function Je(t){return o.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Ge}function Ye(t,s){const r={...s};for(const a in s){const n=t[a],i=s[a];/^on[A-Z]/.test(a)?n&&i?r[a]=(...d)=>{const c=i(...d);return n(...d),c}:n&&(r[a]=n):a==="style"?r[a]={...n,...i}:a==="className"&&(r[a]=[n,i].filter(Boolean).join(" "))}return{...t,...r}}function Ze(t){var a,n;let s=(a=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:a.get,r=s&&"isReactWarning"in s&&s.isReactWarning;return r?t.ref:(s=(n=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:n.get,r=s&&"isReactWarning"in s&&s.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Qe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],K=Qe.reduce((t,s)=>{const r=Ue(`Primitive.${s}`),a=o.forwardRef((n,i)=>{const{asChild:m,...d}=n,c=m?r:s;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(c,{...d,ref:i})});return a.displayName=`Primitive.${s}`,{...t,[s]:a}},{}),V="Checkbox",[et,vt]=Re(V),[tt,U]=et(V);function st(t){const{__scopeCheckbox:s,checked:r,children:a,defaultChecked:n,disabled:i,form:m,name:d,onCheckedChange:c,required:j,value:b="on",internal_do_not_use_render:h}=t,[k,N]=De({prop:r,defaultProp:n??!1,onChange:c,caller:V}),[C,E]=o.useState(null),[I,u]=o.useState(null),l=o.useRef(!1),x=C?!!m||!!C.closest("form"):!0,g={checked:k,disabled:i,setChecked:N,control:C,setControl:E,name:d,form:m,value:b,hasConsumerStoppedPropagationRef:l,required:j,defaultChecked:P(n)?!1:n,isFormControl:x,bubbleInput:I,setBubbleInput:u};return e.jsx(tt,{scope:s,...g,children:rt(h)?h(g):a})}var be="CheckboxTrigger",ge=o.forwardRef(({__scopeCheckbox:t,onKeyDown:s,onClick:r,...a},n)=>{const{control:i,value:m,disabled:d,checked:c,required:j,setControl:b,setChecked:h,hasConsumerStoppedPropagationRef:k,isFormControl:N,bubbleInput:C}=U(be,t),E=q(n,b),I=o.useRef(c);return o.useEffect(()=>{const u=i==null?void 0:i.form;if(u){const l=()=>h(I.current);return u.addEventListener("reset",l),()=>u.removeEventListener("reset",l)}},[i,h]),e.jsx(K.button,{type:"button",role:"checkbox","aria-checked":P(c)?"mixed":c,"aria-required":j,"data-state":Ce(c),"data-disabled":d?"":void 0,disabled:d,value:m,...a,ref:E,onKeyDown:te(s,u=>{u.key==="Enter"&&u.preventDefault()}),onClick:te(r,u=>{h(l=>P(l)?!0:!l),C&&N&&(k.current=u.isPropagationStopped(),k.current||u.stopPropagation())})})});ge.displayName=be;var je=o.forwardRef((t,s)=>{const{__scopeCheckbox:r,name:a,checked:n,defaultChecked:i,required:m,disabled:d,value:c,onCheckedChange:j,form:b,...h}=t;return e.jsx(st,{__scopeCheckbox:r,checked:n,defaultChecked:i,disabled:d,required:m,onCheckedChange:j,name:a,form:b,value:c,internal_do_not_use_render:({isFormControl:k})=>e.jsxs(e.Fragment,{children:[e.jsx(ge,{...h,ref:s,__scopeCheckbox:r}),k&&e.jsx(Ne,{__scopeCheckbox:r})]})})});je.displayName=V;var ke="CheckboxIndicator",ye=o.forwardRef((t,s)=>{const{__scopeCheckbox:r,forceMount:a,...n}=t,i=U(ke,r);return e.jsx(Ae,{present:a||P(i.checked)||i.checked===!0,children:e.jsx(K.span,{"data-state":Ce(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:s,style:{pointerEvents:"none",...t.style}})})});ye.displayName=ke;var ve="CheckboxBubbleInput",Ne=o.forwardRef(({__scopeCheckbox:t,...s},r)=>{const{control:a,hasConsumerStoppedPropagationRef:n,checked:i,defaultChecked:m,required:d,disabled:c,name:j,value:b,form:h,bubbleInput:k,setBubbleInput:N}=U(ve,t),C=q(r,N),E=He(i),I=Te(a);o.useEffect(()=>{const l=k;if(!l)return;const x=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(x,"checked").set,v=!n.current;if(E!==i&&f){const S=new Event("click",{bubbles:v});l.indeterminate=P(i),f.call(l,P(i)?!1:i),l.dispatchEvent(S)}},[k,E,i,n]);const u=o.useRef(P(i)?!1:i);return e.jsx(K.input,{type:"checkbox","aria-hidden":!0,defaultChecked:m??u.current,required:d,disabled:c,name:j,value:b,form:h,...s,tabIndex:-1,ref:C,style:{...s.style,...I,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Ne.displayName=ve;function rt(t){return typeof t=="function"}function P(t){return t==="indeterminate"}function Ce(t){return P(t)?"indeterminate":t?"checked":"unchecked"}function at({className:t,...s}){return e.jsx(je,{"data-slot":"checkbox",className:w("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx(ye,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(qe,{className:"size-3.5"})})})}const nt=({searchResults:t,onViewExercise:s,onSelectExercise:r})=>e.jsx("div",{className:"space-y-2",children:t.map(a=>e.jsxs("div",{className:"flex justify-between items-center p-4 border rounded-md bg-card text-card-foreground",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:a.name}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(R,{variant:"ghost",size:"icon",onClick:()=>s==null?void 0:s(a.exerciseId),children:e.jsx(pe,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(R,{variant:"ghost",size:"sm",onClick:()=>r(a.exerciseId),children:"Add"})]})]},a.exerciseId))}),ot=({searchTerm:t,searchResults:s,isSearching:r,error:a,onSearchChange:n,onSelectExercise:i,onViewExercise:m,className:d})=>e.jsxs(ne,{className:w("h-full flex flex-col",d),children:[e.jsx(oe,{className:"py-3 px-3",children:e.jsx(Pe,{className:"text-base",children:"Exercise Library"})}),e.jsx("div",{className:"px-3 pb-2",children:e.jsxs("div",{className:"relative",children:[e.jsx($e,{placeholder:"Search exercises...",value:t,onChange:n,className:"pr-8"}),e.jsx(Be,{className:"absolute right-2 top-2.5 h-4 w-4 text-muted-foreground"})]})}),e.jsx(ie,{className:"flex-1 p-2 overflow-y-auto max-h-[calc(100vh-200px)]",children:r?e.jsx("div",{className:"flex items-center justify-center h-24",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Searching..."})}):a?e.jsx("div",{className:"flex items-center justify-center h-24",children:e.jsx("p",{className:"text-sm text-destructive",children:a})}):t.trim()!==""&&s.length===0?e.jsx("div",{className:"flex items-center justify-center h-24",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No exercises found"})}):t.trim()===""?e.jsx("div",{className:"flex items-center justify-center h-24",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter a keyword to search exercises"})}):e.jsx(nt,{searchResults:s,onSelectExercise:i,onViewExercise:m})})]}),we=_e,it=Fe,Se=o.forwardRef(({className:t,...s},r)=>e.jsx(ue,{ref:r,className:w("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));Se.displayName=ue.displayName;const X=o.forwardRef(({className:t,children:s,...r},a)=>e.jsxs(it,{children:[e.jsx(Se,{}),e.jsxs(ce,{ref:a,className:w("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[s,e.jsxs(Oe,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Me,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));X.displayName=ce.displayName;const G=({className:t,...s})=>e.jsx("div",{className:w("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});G.displayName="DialogHeader";const Ee=({className:t,...s})=>e.jsx("div",{className:w("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s});Ee.displayName="DialogFooter";const J=o.forwardRef(({className:t,...s},r)=>e.jsx(le,{ref:r,className:w("text-lg font-semibold leading-none tracking-tight",t),...s}));J.displayName=le.displayName;const Y=o.forwardRef(({className:t,...s},r)=>e.jsx(de,{ref:r,className:w("text-sm text-muted-foreground",t),...s}));Y.displayName=de.displayName;const ct=({title:t,isOpen:s,onClose:r,children:a})=>e.jsx(we,{open:s,onOpenChange:r,children:e.jsxs(X,{children:[e.jsxs(G,{children:[e.jsxs(J,{children:["Add Exercise to ",t]}),e.jsx(Y,{children:"Search and select an exercise to add to your workout."})]}),e.jsx("div",{className:"mt-4 h-96",children:a})]})});function lt({className:t,...s}){return e.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:e.jsx("table",{"data-slot":"table",className:w("w-full caption-bottom text-sm",t),...s})})}function dt({className:t,...s}){return e.jsx("thead",{"data-slot":"table-header",className:w("[&_tr]:border-b",t),...s})}function ut({className:t,...s}){return e.jsx("tbody",{"data-slot":"table-body",className:w("[&_tr:last-child]:border-0",t),...s})}function H({className:t,...s}){return e.jsx("tr",{"data-slot":"table-row",className:w("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",t),...s})}function L({className:t,...s}){return e.jsx("th",{"data-slot":"table-head",className:w("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}function F({className:t,...s}){return e.jsx("td",{"data-slot":"table-cell",className:w("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})}const mt=({exercise:t,onAddSet:s,onDeleteSet:r,OnSaveReps:a,OnSaveWeight:n,className:i,id:m})=>{const{sets:d=0,weight:c=0,reps:j=0,exerciseId:b}=t;return e.jsx("div",{className:`rounded border p-4 bg-card text-card-foreground ${i??""}`,id:m,children:e.jsxs(lt,{children:[e.jsx(dt,{children:e.jsxs(H,{children:[e.jsx(L,{className:"w-1/4",children:"Set"}),e.jsx(L,{className:"w-1/4",children:"Reps"}),e.jsx(L,{className:"w-1/4",children:"Weight"}),e.jsx(L,{className:"w-1/4 text-right"})]})}),e.jsxs(ut,{children:[Array.from({length:d},(h,k)=>e.jsxs(H,{children:[e.jsx(F,{children:k+1}),e.jsx(F,{children:e.jsx(O,{className:"w-16",initialValue:j,onSave:N=>a&&a(N)})}),e.jsx(F,{children:e.jsx(O,{className:"w-16",initialValue:c,onSave:N=>n&&n(N)})}),e.jsx(F,{className:"text-right",children:d>1&&e.jsx(R,{variant:"ghost",size:"icon",onClick:r?()=>r(b):void 0,children:e.jsx(xe,{className:"h-4 w-4"})})})]},k)),e.jsx(H,{children:e.jsx(F,{colSpan:4,className:"text-center ",children:e.jsx(R,{variant:"ghost",size:"icon",onClick:s?()=>s(b):void 0,className:"w-full",children:e.jsx(he,{className:"h-full w-3"})})})})]})]})})},ft=({exercise:t,isOpen:s,onClose:r})=>t?e.jsx(we,{open:s,onOpenChange:r,children:e.jsxs(X,{className:"max-w-md",children:[e.jsxs(G,{children:[e.jsx(J,{children:t.name}),e.jsxs(Y,{children:[t.targetMuscles," - ",t.equipments]})]}),e.jsx("div",{className:"space-y-4 mt-4",children:t.instructions&&t.instructions.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-2",children:"Instructions:"}),t.instructions.map((a,n)=>e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:a},n))]})}),e.jsx(Ee,{className:"flex justify-between",children:e.jsx(R,{onClick:r,size:"sm",children:"Close"})})]})}):null,xt=({children:t,plannedExercise:s,workout:r,isSearching:a,removeExerciseFromWorkout:n,handleViewExerciseDetails:i})=>e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx("div",{children:e.jsxs("div",{className:"flex flex-row",children:[e.jsx(R,{variant:"ghost",size:"icon",onClick:()=>i(s.exerciseId),"aria-label":`View details for ${s.name}`,children:a?e.jsx(me,{className:"h-4 w-4 animate-spin"}):e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(R,{variant:"ghost",size:"icon",onClick:()=>n(r.id,s.exerciseId),"aria-label":`Remove ${s.name} from workout`,children:e.jsx(xe,{className:"h-4 w-4 text-red-400"})})]})})]}),t]},s.exerciseId),ht=()=>{const[t,s]=o.useState(""),r=Le(t,500),[a,n]=o.useState(!1),[i,m]=o.useState([]),[d,c]=o.useState(null);o.useEffect(()=>{(async()=>{if(!r.trim()){m([]);return}n(!0),c(null);try{const h=await ae.searchExercises(r);h.success&&Array.isArray(h.data)?m(h.data):(c("Couldn't retrieve exercise data. Format error."),m([]))}catch(h){console.error("Error searching exercises:",h),c("Couldn't connect to exercise database."),m([])}finally{n(!1)}})()},[r]);const j=o.useCallback(async b=>{n(!0);try{const h=await ae.getExerciseById(b);return h.success?h.data:(c("Failed to fetch exercise details. Please try again."),null)}catch(h){return console.error("Error fetching exercise details:",h),c("Failed to fetch exercise details. Please try again."),null}finally{n(!1)}},[]);return{searchTerm:t,searchResults:i,isSearching:a,error:d,setSearchTerm:s,selectExercise:j}},se=(t,s)=>{const r=$.now();return{id:`temp-plan-${r.toMillis()}`,name:t,workouts:s,createdAt:r,updatedAt:r}},pt=()=>{const{user:t}=ze(),{state:s}=fe(),r=s.userPreferences.workoutDaysPerWeek,[a,n]=o.useState(!0),[i,m]=o.useState(!1),[d,c]=o.useState(void 0);o.useEffect(()=>{if(n(!0),t){const u=Array.from({length:r},(l,x)=>({id:`workout-template-${Date.now()}-${x}`,name:`Workout ${x+1}`,exercises:[],completed:!1}));c(se("My Workout Plan",u))}else c(void 0);n(!1)},[t,r]);const j=o.useCallback((u,l)=>{c(x=>{if(!x)return x;const g=x.workouts.map(f=>{if(f.id!==u)return f;if(f.exercises.some(S=>S.exerciseId===l.exerciseId))return T.error("Exercise Already Exists",{description:`"${l.name}" is already in "${f.name}".`}),f;const v={...l,sets:1,reps:10,weight:0};return T("Exercise Added",{description:`"${l.name}" added to "${f.name}".`}),{...f,exercises:[...f.exercises,v]}});return{...x,workouts:g,updatedAt:$.now()}})},[]),b=o.useCallback((u,l)=>{c(x=>{if(!x)return x;let g,f;const v=x.workouts.map(S=>{if(S.id!==u)return S;const A=S.exercises.find(D=>D.exerciseId===l);return A&&(g=A.name,f=S.name),{...S,exercises:S.exercises.filter(D=>D.exerciseId!==l)}});return g&&f&&T("Exercise Removed",{description:`"${g}" removed from "${f}".`}),{...x,workouts:v,updatedAt:$.now()}})},[]),h=o.useCallback((u,l,x)=>{c(g=>{if(!g)return g;const f=g.workouts.map(v=>{if(v.id!==u)return v;const S=v.exercises.map(A=>{if(A.exerciseId!==l)return A;const D=v.exercises.find(z=>z.exerciseId===l),_={...A,...x};return x.sets!==void 0&&D&&T.info(`Sets for ${D.name} updated to ${x.sets} in ${v.name}`),_});return{...v,exercises:S}});return{...g,workouts:f,updatedAt:$.now()}})},[]),k=o.useCallback((u,l)=>{c(x=>{if(!x)return x;const g=x.workouts.map(f=>f.id===u?{...f,name:l}:f);return{...x,workouts:g,updatedAt:$.now()}})},[]),N=o.useCallback(u=>{c(l=>{const x=$.now();if(!l){const g=Array.from({length:r},(f,v)=>({id:`workout-template-${Date.now()}-${v}`,name:`Workout ${v+1}`,exercises:[]}));return se(u,g)}return{...l,name:u,updatedAt:x}})},[r]),C=o.useCallback(()=>{if(!t){T.error("User not authenticated. Cannot save workout plan.");return}if(!d){T.error("Workout plan is not initialized. Cannot save.");return}const u=d.name||"My Workout Plan",l=$.now(),x=d.id&&!d.id.startsWith("temp-plan-")?d.id:`${u.replace(/\s+/g,"-")}-${l.toMillis()}`,g={...d,id:x,name:u,updatedAt:l,createdAt:d.createdAt||l};return c(g),g},[t,d]),E=o.useMemo(()=>(d==null?void 0:d.workouts)||[],[d]),I=o.useCallback(async()=>{const u=C();if(!u)return!1;m(!0);try{return await bt(u),!0}catch(l){return console.error("Error saving workout plan:",l),!1}finally{m(!1)}},[C]);return{isLoading:a,isSaving:i,plannedWorkouts:d,workouts:E,numberOfWorkoutsPerWeek:r,addExerciseToWorkout:j,removeExerciseFromWorkout:b,updateExerciseInWorkout:h,preparePlanForSave:C,setWorkoutName:k,setWorkoutTitle:N,saveWorkoutPlan:I}},Nt=()=>{var ee;const{workouts:t,plannedWorkouts:s,isLoading:r,isSaving:a,addExerciseToWorkout:n,removeExerciseFromWorkout:i,updateExerciseInWorkout:m,setWorkoutTitle:d,setWorkoutName:c,saveWorkoutPlan:j}=pt(),{state:b,setWorkoutDaysPerWeek:h}=fe(),{searchTerm:k,searchResults:N,isSearching:C,error:E,setSearchTerm:I,selectExercise:u}=ht(),[l,x]=o.useState(null),[g,f]=o.useState(null),v=p=>{x(p)},S=async p=>{const y=await u(p);y&&f(y)},A=p=>{l&&n(l,p),_()},D=p=>{if(l){const y=N.find(W=>W.exerciseId===p);y&&n(l,y)}_()},_=()=>{x(null),f(null),I("")},z=(p,y,W)=>{const B=y.sets||0,M=W?B+1:Math.max(0,B-1);m(p,y.exerciseId,{sets:M})},Q=(p,y,W,B)=>{console.log("reps",W);const M=typeof W=="string"?parseInt(W,10):W;isNaN(M)||m(p,y.exerciseId,{[B]:M})},Ie=async()=>{await j()?T.success("Workout plan saved successfully!"):T.error("Failed to save workout plan.")};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx(O,{as:"h1",className:"text-2xl font-bold",initialValue:(s==null?void 0:s.name)||"",onSave:p=>d(p)}),e.jsx("div",{className:"flex justify-end items-center space-x-4",children:e.jsxs("p",{className:"text-sm text-gray-500",children:["You prefer to work out",e.jsx(O,{as:"span",className:"font-medium mx-1 fit-content w-8",initialValue:b.userPreferences.workoutDaysPerWeek.toString(),onSave:p=>h(parseInt(p)),type:"number"}),"times a week."]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:t.map(p=>e.jsxs(ne,{id:`workout-${p.id}`,children:[e.jsx(oe,{children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{className:"flex flex-row justify-between items-center w-full",children:[e.jsx(O,{className:"text-sm font-semibold",initialValue:p.name,onSave:y=>c(p.id,y)}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"completed?"}),e.jsx(at,{className:"h-4 w-4",id:`workout-completed-${p.id}`})]})]})})}),e.jsxs(ie,{children:[e.jsxs(R,{variant:"outline",className:"w-full mb-4",onClick:()=>v(p.id),children:[e.jsx(he,{className:"mr-2 h-4 w-4"})," Add Exercise"]}),e.jsx("div",{className:"space-y-4",children:p.exercises.map(y=>e.jsx(xt,{plannedExercise:y,workout:p,removeExerciseFromWorkout:i,handleViewExerciseDetails:S,children:e.jsx(mt,{exercise:y,onAddSet:()=>z(p.id,y,!0),onDeleteSet:()=>z(p.id,y,!1),OnSaveReps:W=>Q(p.id,y,W,"reps"),OnSaveWeight:W=>Q(p.id,y,W,"weight")})},y.exerciseId))})]})]},p.id))}),e.jsx(ft,{exercise:g,isOpen:!!g,onClose:_}),e.jsx(ct,{title:`Add Exercise to ${((ee=t.find(p=>p.id===l))==null?void 0:ee.name)||"Workout"}`,isOpen:!!l,onClose:_,onSelectExercise:A,onViewExercise:()=>console.log(""),children:e.jsx(ot,{searchTerm:k,searchResults:N,isSearching:C,error:E,onSearchChange:p=>I(p.target.value),onSelectExercise:D,onViewExercise:S})}),e.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:e.jsxs(R,{variant:"default",onClick:Ie,disabled:r||!s,children:[a&&e.jsx(me,{className:"animate-spin mr-2"}),"Save Workout Plan"]})})]})},re="https://exercisedb-api.vercel.app/api/v1",ae={getExerciseById:async t=>{try{const s=await fetch(`${re}/exercises/${t}`);if(!s.ok)throw new Error(`Exercise API error: ${s.status}`);return await s.json()}catch(s){throw console.error(`Error getting exercise data for ID ${t}:`,s),s}},searchExercises:async t=>{try{const s=await fetch(`${re}/exercises/autocomplete?search=${encodeURIComponent(t)}`);if(!s.ok)throw new Error(`Exercise API error: ${s.status}`);return await s.json()}catch(s){throw console.error("Error searching exercises:",s),s}}},Z=new Ve("plannedWorkouts"),bt=async t=>{try{return await Z.add(t),!0}catch(s){return console.error("Error adding workout:",s),!1}},Ct=async()=>{try{return await Z.getAll()}catch(t){return console.error("Error fetching workouts:",t),[]}},wt=async t=>{try{return await Z.delete(t),!0}catch(s){return console.error("Error deleting workout:",s),!1}};export{ft as DetailsDialog,mt as ExerciseItem,ot as SearchPanel,ct as SelectionDialog,xt as WorkoutColumn,Nt as WorkoutPlanner,bt as addPlannedWorkout,wt as deletePlannedWorkout,ae as exerciseApi,Ct as getPlannedWorkouts,ht as useExerciseData,pt as useWorkoutPlanner};
